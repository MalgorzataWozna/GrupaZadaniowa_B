---
title: "Wgranie danych"
author: "Małgorzata Woźna"
date: "7 maja 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
```{r}
library(jsonlite)
library(tseries)

dane <- read.csv2("GUS.csv", header=FALSE)
pure_data <-dane[2:31,2:13]
head(pure_data)
```

```{r}
pure_inv_data <- pure_data[dim(pure_data)[1]:1, ]
head(pure_inv_data)
```



```{r}
library(jsonlite)
data_vec = as.vector(t(pure_inv_data))
```

```{r}
d2 = lapply(data_vec, function(x) return(sub(',','.', x)))
data_vec
```
```{r}
data_vec_with_dot = unlist(d2)
```


```{r}
num_data_vec = as.numeric(data_vec_with_dot)
num_data_vec
```
```{r}
df=data.frame(num_data_vec)
new_dane=num_data_vec[1:351]
new_dane
```


```{r}
plot(num_data_vec, type = "l")
```
```{r}
library(dplyr)
library(forecast)
frequency(new_dane)
```
Co oznacza brak sezonowości

```{r}
sc = ts(new_dane, frequency = 1)
adf.test(sc)
```
```{r}
new_dane1=diff(new_dane)
plot(new_dane1, type = "l")

```
```{r}
adf.test(new_dane1)
```


Wykresy ACF i PACF


```{r}
tsdisplay(new_dane1)
```

```{r}
library(zoo)
srednia_kroczaca=rollmean(sc, 1)
plot(srednia_kroczaca)
```

Usuniecie trędu z naszych danych

```{r}
dAP = diff(sc)
plot(dAP)


Podzielmy nasze dane zbiory uczące i testowe
```{r}
l=length(new_dane1)
l
```
```{r}
test2019=window(new_dane1,start=349)
  
train2019=window(new_dane1,end=348)
  
test2019
```
```{r}
test2018=window(new_dane1,start=337, end=348 )
train2018=window(new_dane1,end=336)
```
```{r}
test2015=window(new_dane1,start=301,end=312)
train2015=window(new_dane1, end=300)
```
```{r}
test2010=window(new_dane1,start=241,end=252)
train2010=window(new_dane1,end=240)
```
 
Box-Cox

```{r}

lambda = BoxCox.lambda(new_dane1, lower = 0, upper = 2)
lambda

```

```{r}
y<-BoxCox(new_dane1, lambda)
plot(y, type = "l")
```

```{r}
modelArima = auto.arima(y)
summary(modelArima)
```


